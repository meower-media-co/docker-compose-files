networks:
    meower:
        external: true

services:
    registry:
        image: registry:2
        environment:
            REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY: /data
        volumes:
            - /mnt/meower/registry:/data
        networks:
            - meower
        ports:
            - "5000:5000"
        deploy:
            mode: replicated
            replicas: 1
            endpoint_mode: vip
            restart_policy:
                condition: on-failure
                delay: 5s
                max_attempts: 3
                window: 120s
            placement:
                constraints:
                    - node.labels.zone == mike
